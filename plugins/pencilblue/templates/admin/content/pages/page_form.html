^tmp_admin=head^
<div class="col-md-9">
    ^tmp_admin=elements=error_success^
    ^tmp_admin=elements=sub_nav^
    ^tmp_admin=elements=tab_nav^
    <form name="pageForm" novalidate>
        <fieldset>
            <div class="tab-content">
                <div class="tab-pane active" id="content">
                    <div class="form-group" ng-class="{'has-error': !isFieldValid(pageForm.headline)}">
                         <label>^loc_pages.HEADLINE^</label>
                         <input type="text" name="headline" class="form-control" ng-model="page.headline" required></input>
                         <div class="form_error" ng-if="!isFieldValid(pageForm.headline)">^loc_generic.REQUIRED_FIELD^</div>
                    </div>
                    <div class="form-group">
                         <label>^loc_pages.SUBHEADING^</label>
                         <input type="text" class="form-control" ng-model="page.subheading"></input>
                    </div>
                    <div class="form-group" ng-class="{'has-error': !isFieldValid(pageForm.url)}">
                        <label>^loc_pages.PAGE_URL^</label>
                        <div class="input-group">
                            <span class="input-group-addon">/page/</span>
                            <input type="text" name="url" class="form-control" placeholder="^loc_pages.CUSTOM_URL^" ng-model="page.url" ng-change="resetUrlAvailability()" url-safe required></input>
                            <span class="input-group-btn">
                                <button type="button" class="btn" ng-class="{'btn-default': urlGenerated === null, 'btn-success': urlGenerated === true, 'btn-danger': urlGenerated === false}" ng-click="getUrl()" ng-disabled="pageForm.headline.$invalid">
									<span ng-if="urlGenerated === null">^loc_users.GENERATE^</span>
									<span ng-if="urlGenerated === true"><i class="fa fa-check"></i>&nbsp;^loc_admin.GENERATED^</span>
									<span ng-if="urlGenerated === false"><i class="fa fa-ban"></i>&nbsp;^loc_admin.NOT_GENERATED^</span>
								</button>
                                <button type="button" class="btn" ng-class="{'btn-default': urlAvailable === null, 'btn-success': urlAvailable === true, 'btn-danger': urlAvailable === false}" ng-click="getUrlAvailability()" ng-disabled="!page.url.length">
                                    <span ng-if="urlAvailable === null">^loc_generic.CHECK^</span>
                                    <span ng-if="urlAvailable === true"><i class="fa fa-check"></i>&nbsp;^loc_generic.AVAILABLE^</span>
                                    <span ng-if="urlAvailable === false"><i class="fa fa-ban"></i>&nbsp;^loc_generic.UNAVAILABLE^</span>
                                </button>
                            </span>
                        </div>
                        <div class="form_error" ng-if="!isFieldValid(pageForm.url)">^loc_generic.REQUIRED_FIELD^</div>
                    </div>
                    <div class="form-group">
                        <label>^loc_articles.STANDALONE_TEMPLATE^</label>
                        <select class="form-control" ng-model="page.template">
                            <option value="">^loc_generic.THEME_DEFAULT^</option>
                            <option ng-value="template.theme_uid + '|' + template.file" ng-repeat="template in templates" ng-bind="template.theme_name + ': ' + template.name" ng-selected="page.template === (template.theme_uid + '|' + template.file)"></option>
                        </select>
                    </div>
                    <div class="form-group" ng-if="availableAuthors.length">
                        <label>^loc_admin.AUTHOR^</label>
                        <select class="form-control" ng-model="page.author" ng-options="availableAuthor._id as availableAuthor.name for availableAuthor in availableAuthors"></select>
                    </div>
                    <div class="form-group" ng-class="{'has-error': !isFieldValid(pageForm.publish_date)}">
                        <label>^loc_pages.PUBLISH_DATE^</label>
                        <div class="input-group">
                            <input type="text" name="publish_date" id="publish_date" class="form-control" ng-model="page.publish_date" required></input>
                            <span class="input-group-btn">
                                <button class="btn btn-default" type="button" ng-click="setPublishDateToNow()">^loc_generic.NOW^</button>
                            </span>
                        </div>
                        <div class="form_error" ng-if="!isFieldValid(pageForm.publish_date)">^loc_generic.REQUIRED_FIELD^</div>
                    </div>
                    <div class="form-group" ng-class="{'has-error': !isWysiwygValid(layout)}">
                      <wysiwyg layout="layout" media="page.page_media"></wysiwyg>
                      <div class="form_error" ng-if="!isWysiwygValid(layout)" style="margin-top: -1em">^loc_generic.REQUIRED_FIELD^</div>
                    </div>
                </div>
                <div class="tab-pane" id="media">
                    ^tmp_admin=elements=inline_media^
                </div>
                <div class="tab-pane" id="topics_dnd">
                    ^tmp_admin=elements=topic_select^
                </div>
                <div class="tab-pane" id="seo">
                    <div class="form-group">
                        <label>^loc_admin.FOCUS_KEYWORD^</label>
                        <input type="text" class="form-control" ng-model="page.focus_keyword" placeholder="^loc_admin.FOCUS_KEYWORD_PLACEHOLDER^"></input>
                    </div>
                    <div class="form-group">
                        <label>^loc_admin.SEO_TITLE^</label>
                        <input type="text" class="form-control" ng-model="page.seo_title" placeholder="^loc_admin.SEO_TITLE_PLACEHOLDER^" maxlength="70"></input>
                    </div>
                    <div class="form-group">
                        <label>^loc_admin.META_DESC^</label>
                        <textarea class="form-control" ng-model="page.meta_desc" placeholder="^loc_admin.META_DESC_PLACEHOLDER^" maxlength="156"></textarea>
                    </div>
                    <div class="form-group">
                        <label>^loc_admin.META_KEYWORDS^</label>
                        <input type="text" class="form-control" ng-model="page.meta_keywords" placeholder="^loc_admin.META_KEYWORDS_PLACEHOLDER^"></input>
                    </div>
                    <div class="form-group" ng-if="page.page_media.length">
                        <label>^loc_generic.THUMBNAIL^</label>
                        <select class="form-control" ng-model="page.thumbnail">
                            <option ng-value="media._id" ng-repeat="media in page.page_media" ng-selected="page.thumbnail === media._id" ng-bind="media.name" ng-if="media.media_type === 'image'"></option>
                        </select>
                    </div>
                </div>
                <a class="btn btn-default" href="/admin/content/pages">
                    <i class="fa fa-ban"></i>&nbsp;^loc_generic.CANCEL^
                </a>&nbsp;
                <button type="button" class="btn btn-info" ng-click="previewPage(true)" ng-if="page.draft" ng-disabled="savingPage">
                    <i class="fa" ng-class="{'fa-eye': !savingPage, 'fa-circle-o-notch fa-spin': savingPage}"></i>&nbsp;^loc_generic.PREVIEW^
                </button>
                <span ng-if="page.draft">&nbsp;</span>
                <div class="btn-group dropup">
                    <button type="button" class="btn btn-primary" ng-click="savePage()" ng-if="!page.draft && page._id" ng-disabled="savingPage">
                        <i class="fa" ng-class="{'fa-save': !savingPage, 'fa-circle-o-notch fa-spin': savingPage}"></i>&nbsp;^loc_generic.SAVE^
                    </button>
                    <button id="save_draft_button" type="button" class="btn btn-primary" ng-click="savePage(true)" ng-if="page.draft || !page._id" ng-disabled="savingPage">
                        <i class="fa" ng-class="{'fa-save': !savingPage, 'fa-circle-o-notch fa-spin': savingPage}"></i>&nbsp;^loc_generic.SAVE_DRAFT^
                    </button>
                    <button type="button" class="btn btn-primary dropdown-toggle" data-toggle="dropdown">
                        <i class="fa fa-sm fa-chevron-up"></i>
                    </button>
                    <ul class="dropdown-menu" role="menu">
                        <li ng-if="!page.draft && page._id"><a ng-click="savePage(true)">^loc_generic.SAVE_DRAFT^</a></li>
                        <li ng-if="page.draft || !page._id"><a ng-click="savePage()">^loc_generic.SAVE^</a></li>
                    </ul>
                </div>
                <div class="spacer"></div>
                <label id="draft_info" ng-if="page._id">
                  <span ng-if="page.draft">^loc_generic.DRAFT_SAVED^</span>
                  <span ng-if="!page.draft">^loc_generic.LAST_SAVED^</span>&nbsp;
                  <span id="draft_time">{{page.last_modified | date: 'yyyy-MM-dd HH:mm:ss'}}</span>
                </label>
            </div>
            <div class="additions" style="display: none"></div>
        </fieldset>
    </form>
</div>
^tmp_admin=elements=wysiwyg_scripts^
^tmp_angular=admin=content=pages=page_form^
^tmp_admin=footer^
